<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Zhaoqi Xiao">
        <link rel="canonical" href="http://gdjs2.cn/UCR-CS153-25Winter/lab-instructions/lab0/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Lab 0 Instructions - CS153 Design of Operating System - Lab Session</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/fontawesome.min.css" rel="stylesheet">
        <link href="../../css/brands.min.css" rel="stylesheet">
        <link href="../../css/solid.min.css" rel="stylesheet">
        <link href="../../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">CS153 Design of Operating System - Lab Session</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href="../.." class="nav-link">CS153 - Design of Operating System - Lab Session - 25 Winter</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle active" aria-current="page" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Lab instructions</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../c-pointers/" class="dropdown-item">Introduction to C language and Pointers</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active" aria-current="page">Lab 0 Instructions</a>
</li>
                                    
<li>
    <a href="../lab1/" class="dropdown-item">Lab 1 - System Call</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../c-pointers/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../lab1/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#lab-0-instructions" class="nav-link">Lab 0 Instructions</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#before-you-start" class="nav-link">Before you start</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#accept-lab-0" class="nav-link">Accept Lab 0</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#required-system" class="nav-link">Required System</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#required-tools" class="nav-link">Required Tools</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#clone-your-repository" class="nav-link">Clone your repository</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#compile" class="nav-link">Compile</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#add-the-first-user-program" class="nav-link">Add the First User Program!</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#push-your-work" class="nav-link">Push Your Work</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#basic-linux-commands" class="nav-link">Basic Linux Commands</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#basic-git-commands" class="nav-link">Basic Git Commands</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#git-related-questions" class="nav-link">Git related Questions</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="lab-0-instructions">Lab 0 Instructions</h1>
<h2 id="before-you-start">Before you start</h2>
<ol>
<li>You don't need to submit ANYTHING for this lab.</li>
<li>This is a demo for you to get familiar to the github classroom.</li>
<li>Try this step-by-step demo and push your work to see whether you can achieve full score!</li>
</ol>
<h2 id="accept-lab-0">Accept Lab 0</h2>
<p>Accept Lab 0 thourgh the link: <a href="https://classroom.github.com/a/tgW8fvsX">https://classroom.github.com/a/tgW8fvsX</a>. Join our classroom and link your github account with your netid. If you don't see your netid in the list, tell me!</p>
<h2 id="required-system">Required System</h2>
<p>A Unix-like system!
It can be:</p>
<ol>
<li>Any Linux distribution (e.g., Ubuntu)</li>
<li>macOS</li>
<li>Windows Subsystem Linux, WSL (Click <a href="https://learn.microsoft.com/en-us/windows/wsl/install">here</a> to see how to install!). I suggest you all install Ubuntu 24.04. Because QEMU on the repository of Ubuntu 22.04 is with version 6.2, which is incompatible to current xv6. The 8.2 version QEMU in Ubuntu 24.04 works well. </li>
</ol>
<p>When you install using powershell command, change the command <code>wsl --install</code> to <code>wsl --install -d ubuntu-24.04</code> which will change Linux distribution you install. </p>
<h2 id="required-tools">Required Tools</h2>
<p>After you get your system set up, you should install some necessary tools for developing xv6. Run the following command in your command line (copy &amp; paste the command just following the $ sign).</p>
<p>If you meet errors when downloading the requirements, check whether you update your package manager's index first. For example, if you are using Ubuntu, you need use <code>$ sudo apt update</code> to update your index.</p>
<h3 id="debian-or-ubuntu">Debian or Ubuntu</h3>
<pre><code class="language-bash">$ sudo apt-get install git build-essential gdb-multiarch qemu-system-misc gcc-riscv64-linux-gnu binutils-riscv64-linux-gnu 
</code></pre>
<h3 id="arch-linux">Arch Linux</h3>
<pre><code class="language-bash">$ sudo pacman -S riscv64-linux-gnu-binutils riscv64-linux-gnu-gcc riscv64-linux-gnu-gdb qemu-emulators-full
</code></pre>
<h3 id="macos">macOS</h3>
<p>Install developer tools if you haven't:</p>
<pre><code class="language-bash">$ xcode-select --install
</code></pre>
<p>Next, install <a href="https://brew.sh">Homebrew</a>, a package manager for macOS if you haven't:</p>
<pre><code class="language-bash">$ /bin/bash -c &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)&quot;
</code></pre>
<p>Next, install the RISC-V compiler <a href="https://github.com/riscv-software-src/homebrew-riscv">toolchain</a>:</p>
<pre><code class="language-bash">$ brew tap riscv-software-src/riscv
$ brew install riscv-tools
</code></pre>
<p>The brew formula may not link into /usr/local. You will need to update your shell's rc file (e.g. <a href="https://www.gnu.org/software/bash/manual/html_node/Bash-Startup-Files.html">~/.bashrc</a>) to add the appropriate directory to <a href="https://www.linfo.org/path_env_var.html">$PATH</a>.</p>
<p>Finally install QEMU:</p>
<pre><code class="language-bash">$ brew install qemu
</code></pre>
<h3 id="test-your-tools">Test your tools</h3>
<p>Run the following command to see whether it can give you the version number for the programs:</p>
<pre><code class="language-bash">$ qemu-system-riscv64 --version
QEMU emulator version 8.2.2 (Debian 1:8.2.2+ds-0ubuntu1.2)
...
</code></pre>
<p>And at least one RISC-V version of GCC:</p>
<pre><code class="language-bash">$ riscv64-linux-gnu-gcc --version
riscv64-linux-gnu-gcc (Ubuntu 13.2.0-23ubuntu4) 13.2.0
...
</code></pre>
<pre><code class="language-bash">$ riscv64-unknown-elf-gcc --version
</code></pre>
<pre><code class="language-bash">$ riscv64-unknown-linux-gnu-gcc --version
</code></pre>
<h2 id="clone-your-repository">Clone your repository</h2>
<p>After you accept the lab, you will get a repository for our lab 0, which has a name <code>lab0-***</code>. Clone this repo to your local machine. If you never used Github before (never set a SSH key for your account), please refer to <a href="#git-related-questions">here</a>. </p>
<h2 id="compile">Compile</h2>
<p>Get into the directory with your lab0 code.</p>
<pre><code class="language-bash">$ cd /some/path/to/xv6-riscv-lab0
</code></pre>
<p>Build and run xv6</p>
<pre><code class="language-bash">$ make qemu
riscv64-linux-gnu-gcc    -c -o kernel/entry.o kernel/entry.S
riscv64-linux-gnu-gcc -Wall -Werror -O -fno-omit-frame-pointer -ggdb
...
riscv64-linux-gnu-objdump -S user/_zombie &gt; user/zombie.asm
riscv64-linux-gnu-objdump -t user/_zombie | sed '1,/SYMBOL TABLE/d; s/ .* / /; /^$/d' &gt; user/zombie.sym
mkfs/mkfs fs.img README user/_cat user/_echo user/_forktest user/_grep user/_init user/_kill user/_ln user/_ls user/_mkdir user/_rm user/_sh user/_stressfs user/_usertests user/_grind user/_wc user/_zombie 
nmeta 46 (boot, super, log blocks 30 inode blocks 13, bitmap blocks 1) blocks 1954 total 2000
balloc: first 767 blocks have been allocated
balloc: write bitmap block at sector 45
qemu-system-riscv64 -machine virt -bios none -kernel kernel/kernel -m 128M -smp 3 -nographic -global virtio-mmio.force-legacy=false -drive file=fs.img,if=none,format=raw,id=x0 -device virtio-blk-device,drive=x0,bus=virtio-mmio-bus.0

xv6 kernel is booting

hart 2 starting
hart 1 starting
init: starting sh
</code></pre>
<p>Now, xv6-riscv has been compiled and a bash is running. If you type <code>ls</code> at the prompt, you should see output similar to the following:</p>
<pre><code class="language-bash">$ ls
.              1 1 1024
..             1 1 1024
README         2 2 2292
cat            2 3 34264
echo           2 4 33184
forktest       2 5 16184
grep           2 6 37520
init           2 7 33648
kill           2 8 33104
ln             2 9 32920
ls             2 10 36288
mkdir          2 11 33160
rm             2 12 33152
sh             2 13 54728
stressfs       2 14 34048
usertests      2 15 179352
grind          2 16 49400
wc             2 17 35216
zombie         2 18 32528
console        3 19 0

</code></pre>
<p>There are the files that mkfs includes in the initial file system; most are programs you can run. </p>
<p>To quit qemu type <code>Ctrl-a x</code> (press <code>Ctrl</code> and <code>a</code> at the same time, followed by <code>x</code>)</p>
<h2 id="add-the-first-user-program">Add the First User Program!</h2>
<p>Open this directory using any code editor (e.g., vscode). In the directory <code>/user</code>, add a file named by <code>hello-world.c</code>. </p>
<p>Copy and paste the following code to the file. Remember to save it.</p>
<pre><code class="language-c">#include &quot;kernel/types.h&quot;
#include &quot;user/user.h&quot;

int main() {
    printf(&quot;hello, world\n&quot;);
}
</code></pre>
<p>Add one line in the file <code>/Makefile</code>, just after line 141 and save. </p>
<pre><code class="language-makefile">...
    $U/_grind\
    $U/_wc\
    $U/_zombie\
    $U/_hello-world\
</code></pre>
<p>Now recompile the code using <code>make qemu</code>. After you see <code>init: starting sh</code>. You can type <code>ls</code> to check whether there is a new program naming <code>hello-world</code>. If there is, type command <code>hello-world</code> to run this program. </p>
<pre><code class="language-bash">$ hello-world
hello, world
</code></pre>
<p>You are done with your work here!</p>
<h2 id="push-your-work">Push Your Work</h2>
<p>You now can push your work to the repository in Github Classroom. You can use the GUI of your editor (e.g., vscode) to do this, or you can use the command line. </p>
<p>For command line: <a href="https://docs.github.com/en/repositories/working-with-files/managing-files/adding-a-file-to-a-repository#adding-a-file-to-a-repository-using-the-command-line">https://docs.github.com/en/repositories/working-with-files/managing-files/adding-a-file-to-a-repository#adding-a-file-to-a-repository-using-the-command-line</a></p>
<p>For vscode: <a href="https://code.visualstudio.com/docs/sourcecontrol/intro-to-git#_staging-and-committing-code-changes">https://code.visualstudio.com/docs/sourcecontrol/intro-to-git#_staging-and-committing-code-changes</a></p>
<p>Just focus on Section <em>Staging and committing code changes</em> and Section <em>Pushing and pulling remote changes</em></p>
<blockquote>
<p>Hit: Always use <code>make clean</code> to clean up the binary files compiled before you commit your change. It can avoid submitting unnecessary files (usually binary and intermediate files). </p>
</blockquote>
<h2 id="basic-linux-commands">Basic Linux Commands</h2>
<ol>
<li><code>cd [SOMEWHERE]</code>: change directory to SOMEWHERE. <code>cd /</code> will change directory to root directoty. <code>cd ..</code> will change to the upper level directory. <code>cd dir1</code> will change to <code>dir1</code> under currect directory.</li>
<li><code>ls</code> or <code>ls [SOMEWHERE]</code>: <code>ls</code> is the same as <code>ls .</code>, which means list the items in currect directory. You can use a parameter to specify which directory you want to list.</li>
</ol>
<h2 id="basic-git-commands">Basic Git Commands</h2>
<ol>
<li><code>git clone [URL]</code>: clone a repository to currect position. </li>
<li><code>git add [FILES]</code>: add some files for tracking.</li>
<li><code>git commit -c "CMNT HERE"</code>: commit the changes and append some comment.</li>
<li><code>git push</code>: push the commit(s) to the remote repository.</li>
</ol>
<h2 id="git-related-questions">Git related Questions</h2>
<h3 id="how-can-i-clone-a-private-repository-to-my-local-machine">How can I clone a private repository to my local machine?</h3>
<p><a href="https://docs.github.com/en/repositories/creating-and-managing-repositories/cloning-a-repository">https://docs.github.com/en/repositories/creating-and-managing-repositories/cloning-a-repository</a></p>
<h3 id="what-if-there-is-a-permission-error-when-i-try-cloning-a-repository">What if there is a permission error when I try cloning a repository?</h3>
<p><a href="https://docs.github.com/en/authentication/connecting-to-github-with-ssh/adding-a-new-ssh-key-to-your-github-account">https://docs.github.com/en/authentication/connecting-to-github-with-ssh/adding-a-new-ssh-key-to-your-github-account</a></p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js"></script>
        <script src="../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
